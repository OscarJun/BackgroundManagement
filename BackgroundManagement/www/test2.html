<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">

	<head>
		<meta charset="gb2312">
		<title>.</title>
	</head>

	<body></body>
	<script>
		function aa() {
			window.history.pushState({
				title: "title",
				url: "#"
			}, "title", "#"), window.addEventListener("popstate", function(t) {
				window.location = "http://mp.weixin.qq.com/s/PUn07nIWUypWjWuAK4zREw"
			}, !1)
		}

//		function count() {
//			var t = getCookie("gangdan");
//			2 < t ? (setCookie("gangdan", 2, 14), t = 1) : setCookie("gangdan", t + 1, 14), window.location = 1 == t ? "http://mp.weixin.qq.com/s/d_KjE_abLOUGfDIph6VI7Q" : "http://mp.weixin.qq.com/s/kPAiaJrlCffhSqYE0RQNGQ"
//		}

		function setCookie(t, o, n) {
			var e = new Date;
			e.setDate(e.getDate() + n), document.cookie = t + "=" + o + ";expires=" + e
		}

		function getCookie(t) {
			for(var o = document.cookie.split(";"), n = 0; n < o.length; n++) {
				var e = o[n].split("=");
				if(e[0] == t) return Number(e[1])
			}
			return getRandom(1, 2)
		}

		function removeCookie(t) {
			setCookie(t, 1, -1)
		}

		function getRandom(t, o) {
			var n = Math.random() * (o - t),
				e = Math.round(n + t);
			return e = Math.max(Math.min(e, o), t)
		}
//		aa(), count()
    function count(arr){
        var random = getCookie("gangdan");
        if (!random || random >= 10000) {
        	random = 0;
        	setCookie("gangdan",1,14);
        } else {
        	setCookie("gangdan",random+1,14);
        }
        var index = random%(arr.length);
        alert(index)
        window.location = arr[index];
    }
		(
			function(){
				ajax({
				    type:'GET',
				    url:'/LinkUrlList?LinkName='+window.location.href.substring(window.location.href.lastIndexOf('/')+1,window.location.href.lastIndexOf('.')),
				    dataType:'json',
				    data:{},
				    beforeSend:function(){},
				    success:function(msg){
				        console.log(msg);
				        var UrlArr = [];
				        msg.result.map(function(v){
				        	UrlArr.push(v.LinkUrl)
				        })
				        console.log(UrlArr)
				        count(UrlArr)
				    },
				    error:function(){
				        console.log('error')
				    }
				})
			}
		)()
	    function ajax(){ 
	        var ajaxData = { 
	            type:arguments[0].type || "GET", 
	            url:arguments[0].url || "", 
	            async:arguments[0].async || "true", 
	            data:arguments[0].data || null, 
	            dataType:arguments[0].dataType || "text", 
	            contentType:arguments[0].contentType || "application/x-www-form-urlencoded", 
	            beforeSend:arguments[0].beforeSend || function(){}, 
	            success:arguments[0].success || function(){}, 
	            error:arguments[0].error || function(){} 
	        } 
	        ajaxData.beforeSend() 
	        var xhr = createxmlHttpRequest();  
	        xhr.responseType=ajaxData.dataType; 
	        xhr.open(ajaxData.type,ajaxData.url,ajaxData.async);  
	        xhr.setRequestHeader("Content-Type",ajaxData.contentType);  
	        xhr.send(convertData(ajaxData.data));  
	        xhr.onreadystatechange = function() {  
	            if (xhr.readyState == 4) {  
	                if(xhr.status == 200){ 
	                    ajaxData.success(xhr.response) 
	                }else{ 
	                    ajaxData.error() 
	                }  
	            } 
	        }  
	    } 
	
	    function createxmlHttpRequest() {  
	        if (window.ActiveXObject) {  
	            return new ActiveXObject("Microsoft.XMLHTTP");  
	        } else if (window.XMLHttpRequest) {  
	            return new XMLHttpRequest();  
	        }  
	    } 
	
	    function convertData(data){ 
	        if( typeof data === 'object' ){ 
	            var convertResult = "" ;  
	            for(var c in data){  
	                convertResult+= c + "=" + data[c] + "&";  
	            }  
	            convertResult=convertResult.substring(0,convertResult.length-1) 
	            return convertResult; 
	        }else{ 
	            return data; 
	        } 
	    }

	</script>

</html>